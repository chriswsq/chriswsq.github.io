<!DOCTYPE html>
<html>
<head>
<link rel="shortcut icon" href="https://chriswsq.github.io/favicon.ico" type="image/x-icon" /><meta name="viewport"content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/><meta name="apple-mobile-web-app-capable"content="yes"/><meta name="apple-mobile-web-app-status-bar-style"content="black"/><meta name="format-detection"content="telephone=no"/><meta name="renderer"content="webkit"><meta name="description"content="å½“ä½ è§‰å¾—æ— æ‰€äº‹äº‹æ—¶ï¼Œé‚£ä½ å°±æ˜¯åœ¨è™šåº¦å…‰é˜´"><meta charset="UTF-8"><title>citaæœåŠ¡ | chris&#39;wang</title>
<link href="https://chriswsq.github.io/styles/main.css" type="text/css" rel="stylesheet" /><link href="https://at.alicdn.com/t/font_1621793_zatzzgvf30g.css" type="text/css" rel="stylesheet" /><link rel="stylesheet" href="https://chriswsq.github.io/media/css/katex.css"><script async src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.min.js"></script><script src="https://chriswsq.github.io/media/js/magnify.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
<script type="text/javascript">function btn_toggle(){document.getElementById("hn").classList.contains("no-js")?document.getElementById("hn").classList.remove("no-js"):document.getElementById("hn").classList.add("no-js")}</script>

<script src='//unpkg.com/valine/dist/Valine.min.js'></script>

<link rel="canonical" href="https://chriswsq.github.io/post/cita-fu-wu/" />
</head>
<body>
<div class="progress"></div><style>.progress{background:linear-gradient(to right,#87ceeb var(--scroll),transparent 0);background-repeat:no-repeat;position:fixed;width:100%;height:4px;z-index:1}</style><div class="darkmode-background"></div><div class="darkmode-layer"></div>
<noscript><p class="warn" >æœ¬é¡µé¢éœ€è¦æµè§ˆå™¨æ”¯æŒï¼ˆå¯ç”¨ï¼‰JavaScript</p></noscript><div class="header"><div class="logo_title"><div class="title animated fadeInDown"><a href="https://chriswsq.github.io"><img alt="logo" style="display:inline-block;" src="https://chriswsq.github.io/images/avatar.png"/></a><h1 title="chris&#39;wang" class="weaklink"><a  href="/">chris&#39;wang</a></h1>

<div class="navbar weaklink">
<div class="normal_nav">
<div class="bitcron_nav_container"><div class="bitcron_nav"><div class="bitcron_nav"><div style="display:flex;justify-content:center;"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a></li></ul></nav>
<div style="float:right;margin-top:1em"><form id="gridea-search-form" data-update="1578893743252" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="Search..."></form></div><div style="margin-left:0.5em;margin-top:1.2em"><input id="switch_default" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
<div class="clear clear_nav_inline_end"></div></div></div><div class="clear clear_nav_end"></div></div></div><div class="hamberger" href="javascript:void(0)" onclick="btn_toggle();"><i class="iconfont icon-category"></i></div></div></div></div>
<div id="hn" class="no-js hidden_nav animated fadeInDown"><div class="bitcron_nav_container"><div class="bitcron_nav"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a></li></ul><div class="clear clear_nav_inline_end"></div></nav></div><div class="clear clear_nav_end"></div></div>
<div style="display:flex;justify-content:center;inline-block;text-align:center;margin-top:7%"><div><form id="gridea-search-form" data-update="1602667104621" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q"  placeholder="Search..." /></form></div><div style="margin-left:0.5em"><input id="switch_default_h" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
</div></div>
<script>function enableDarkmode(){document.body.classList.add("darkmode"),document.getElementById("switch_default").checked=1,document.getElementById("switch_default_h").checked=1}function removeDarkmode(){document.body.classList.remove("darkmode"),document.getElementById("switch_default").checked=0,document.getElementById("switch_default_h").checked=0}function getCookie(a){var b,c=new RegExp("(^| )"+a+"=([^;]*)(;|$)");return(b=document.cookie.match(c))?unescape(b[2]):null}cookie=getCookie("darkmode"),"enable"==cookie&&enableDarkmode(),window.matchMedia("(prefers-color-scheme: dark)").matches&&"disable"!==cookie&&(enableDarkmode(),document.cookie="darkmode=enable; path=/");var mobileBtn=function(){1==document.getElementById("switch_default").checked?(enableDarkmode(),document.cookie="darkmode=enable; path=/"):(removeDarkmode(),document.cookie="darkmode=disable; path=/")};</script>

<div class="main"><div class="main-inner"><div class="content">
<article class="post">
<h2 class="post_title sm_margin"><a>citaæœåŠ¡</a></h2>
<script>function lan(){if(document.getElementById("lan").innerText=="ç¹"){var s=document.getElementById("tongwenlet_cn");if(s!=null){document.body.removeChild(s)}var s=document.createElement("script");s.language="javascript";s.type="text/javascript";s.src="https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_tw.js";s.id="tongwenlet_cn";document.body.appendChild(s);document.getElementById("lan").innerHTML="ç®€"}else{if(document.getElementById("lan").innerText=="ç°¡"){var s=document.getElementById("tongwenlet_cn");if(s!=null){document.body.removeChild(s)}var s=document.createElement("script");s.language="javascript";s.type="text/javascript";s.src="https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_cn.js";s.id="tongwenlet_cn";document.body.appendChild(s);document.getElementById("lan").innerHTML="ç¹"}}};</script>
<section class="post_details"><i class="iconfont icon-calendar"></i><span style="margin-right:15px"> 2020-08-25</span><i class="iconfont icon-browse"></i><span style="margin-right:15px"> <span id="busuanzi_value_page_pv"></span> Views</span><i class="iconfont icon-category"></i><span class="weaklink" style="margin-right:15px">	<a href="https://chriswsq.github.io/tag/vUYHfbEAx/" class="tag">cita</a></span><i class="iconfont icon-caret-down"></i><span style="margin-right:15px">3121å­—</span><i class="iconfont icon-naozhong"></i><span style="margin-right:15px">15 min read</span><a id="lan" href="javascript:void(0);"onclick="lan();"title="è°ƒæ•´ç®€ç¹ä½“" style="margin-right:15px;">ç¹</a>
</section>

<div style="display:flex">
<div class="md_block" id="md_block">
<div class="round-shape-one"></div>
<p>æ ¹æ®å…¬å¸éœ€æ±‚ç ”ç©¶éƒ¨ç½²citaæœåŠ¡</p>
<!-- more -->
<h2 id="å…³äº-cita">å…³äº CITA</h2>
<p>CITA æ˜¯ä¸€ä¸ªé¢å‘ä¼ä¸šçº§åº”ç”¨çš„æ”¯æŒæ™ºèƒ½åˆçº¦çš„é«˜æ€§èƒ½åŒºå—é“¾å†…æ ¸ï¼Œ æ—¨åœ¨ä¸ºä¼ä¸šçº§åŒºå—é“¾åº”ç”¨æä¾›ä¸€ä¸ªç¨³å›ºã€é«˜æ•ˆã€çµæ´»ã€å¯é€‚åº”æœªæ¥çš„è¿è¡Œå¹³å°ã€‚ CITA å°†åŒºå—é“¾èŠ‚ç‚¹çš„å¿…è¦åŠŸèƒ½è§£è€¦ä¸ºå…­ä¸ªå¾®æœåŠ¡ï¼šRPCï¼ŒAuthï¼ŒConsensusï¼ŒChainï¼ŒExecutorï¼ŒNetworkã€‚å„ç»„ä»¶ä¹‹é—´é€šè¿‡æ¶ˆæ¯æ€»çº¿äº¤æ¢ä¿¡æ¯ç›¸äº’åä½œã€‚ é€šè¿‡é…ç½®å’Œå®šåˆ¶ç›¸åº”çš„æœåŠ¡ï¼ŒCITA èƒ½å¤Ÿæ»¡è¶³ä¼ä¸šçº§ç”¨æˆ·çš„å…¨éƒ¨éœ€è¦ã€‚</p>
<p>åŸºç¡€ç¯å¢ƒ<br>
dockerã€docker-compose<br>
éƒ¨ç½²æ–¹å¼<br>
docker-compose<br>
é•œåƒç‰ˆæœ¬<br>
cita/cita-release:20.2.0-sm2-sm3</p>
<blockquote>
<p>æ³¨æ„<br>
å¿…é€‰é…ç½®é¡¹æœ‰ super_admin å’Œ nodesï¼Œç³»ç»Ÿä¸æä¾›é»˜è®¤é…ç½®ã€‚</p>
</blockquote>
<h2 id="å®‰è£…-cita-å®¢æˆ·ç«¯å·¥å…·">å®‰è£… CITA å®¢æˆ·ç«¯å·¥å…·</h2>
<ol>
<li>åˆ›å»ºç›®å½•</li>
</ol>
<p><code>mkdir -p /bsn/cita</code><br>
2. åˆ‡æ¢ç›®å½•</p>
<p><code>cd /bsn/cita</code><br>
3. ä¸‹è½½ CITA-CLI å®‰è£…åŒ…</p>
<pre><code class="language-bash">wget https://github.com/citahub/cita-cli/releases/download/20.2.2/cita-cli-x86_64-musl-tls-20.2.2.tar.gz
</code></pre>
<ol start="4">
<li>è§£å‹ç¨‹åº</li>
</ol>
<p><code>tar zxvf cita-cli-x86_64-musl-tls-20.2.2.tar.gz</code><br>
5. å¤åˆ¶ CITA-CLI åˆ° ç³»ç»Ÿå¯æ‰§è¡Œæ–‡ä»¶ç›®å½•ä¸‹</p>
<p><code>cp -rp cita-cli /usr/local/bin/</code><br>
<code>./cita-cli</code></p>
<h3 id="æŸ¥çœ‹å½“å‰æ‰€åœ¨çš„é“¾å’ŒåŠ å¯†ç®—æ³•">æŸ¥çœ‹å½“å‰æ‰€åœ¨çš„é“¾å’ŒåŠ å¯†ç®—æ³•</h3>
<p><code>cita&gt; info</code></p>
<p>è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<ul>
<li>url : å½“å‰æ‰€åœ¨çš„é“¾</li>
<li>encryption : åŠ å¯†ç®—æ³•</li>
</ul>
</blockquote>
<pre><code class="language-bash">[       url        ]: http://127.0.0.1:1337
[       pwd        ]: /Users/yanli/soft/CITA/toolcita
[      color       ]: true
[      debug       ]: true
[       json       ]: true
[    encryption    ]: secp256k1
[ completion_style ]: List
[    edit_style    ]: Vi
[   save_private   ]: true
</code></pre>
<p>åˆ‡æ¢é“¾<br>
<code>cita&gt; switch --url https://testnet.citahub.com</code></p>
<p>åˆ‡æ¢åŠ å¯†ç®—æ³•<br>
<code>cita&gt; switch --algorithm --help</code></p>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="language-bash">&gt;&gt; switch 
Switch environment variables, such as url/algorithm

USAGE:
    switch [FLAGS] [OPTIONS]

FLAGS:
        --color               Switching color for rpc interface
        --debug               Switching debug mode
        --json                Switching json format
        --completion_style    Switching completion style
        --edit_style          Switching edit style
        --save_private        Switching whether save private key
    -h, --help                Prints help information

OPTIONS:
        --url &lt;url&gt;                Switch url
        --algorithm &lt;algorithm&gt;    Select the encryption algorithm you want, the default is secp256k1 [possible values:
                                   secp256k1, ed25519, sm2]

</code></pre>
<p>å¦‚ï¼šåˆ‡æ¢è‡³ sm2 åŠ å¯†ç®—æ³•<br>
<code>cita&gt; switch --algorithm sm2</code></p>
<h3 id="åˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦æˆ·åœ°å€-ç§é’¥-å…¬é’¥">åˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦æˆ·åœ°å€ã€ç§é’¥ã€å…¬é’¥</h3>
<p>æ‰§è¡Œå‘½ä»¤ï¼š<br>
<code>cita&gt; key create</code></p>
<p>å‘½ä»¤è¿”å›ï¼š</p>
<pre><code class="language-bash">{
  &quot;address&quot;: &quot;0xbac32b0a26bb3380e3f1a8b99af8f32922708730&quot;,
  &quot;private&quot;: &quot;0x7664a098547142fdf7fc3a732607f707512f98df4d6b7040f009858813e257d5&quot;,
  &quot;public&quot;: &quot;0x91f9dad655d7ccec4830fa036b0e5311c995acf960bc84df901f54fd232060b99fbc2672d64075263d0f4f4b0d50b1ddf6c22bc9b402626dfa726b2d532918b0&quot;
}

</code></pre>
<blockquote>
<p>æ³¨ï¼šæ­¤å¤„ä¸ºç¤ºä¾‹å…¬ç§é’¥å¯¹ï¼Œä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒå¤åˆ¶ä½¿ç”¨ï¼Œå…¶ä¸­ï¼š</p>
</blockquote>
<blockquote>
<ul>
<li>&quot;address&quot;ï¼š è´¦æˆ·åœ°å€</li>
<li>&quot;private&quot;ï¼šè´¦æˆ·ç§é’¥</li>
<li>&quot;public&quot;ï¼šè´¦æˆ·å…¬é’¥</li>
</ul>
</blockquote>
<h2 id="docker-compose-éƒ¨ç½²citaæœåŠ¡">docker-compose éƒ¨ç½²citaæœåŠ¡</h2>
<h3 id="1-ç”ŸæˆèŠ‚ç‚¹é…ç½®æ–‡ä»¶">1. ç”ŸæˆèŠ‚ç‚¹é…ç½®æ–‡ä»¶</h3>
<p>docker-compose-conf.yml</p>
<pre><code class="language-yml">version: '3'
networks:
  main:

services:
  config:
    container_name: config
    environment:
      - SUPER_ADMIN=0x4b5ae4567ad5d9fb92bc9afd6a657e6fa13a2523
      - NODES_CONFIG=192.168.40.6:4000,192.168.40.7:4000,192.168.40.8
    image: cita/cita-release:20.2.0-sm2-sm3
    hostname: config
    networks:
      main:
        aliases:
          - config
    volumes:
      - ./:/opt/cita-run
    command: |
      bash -c '
      echo &quot;Create config files...&quot;;
      cita create --super_admin &quot;$$SUPER_ADMIN&quot; --nodes &quot;$$NODES_CONFIG&quot;;
      echo &quot;Done config&quot;'
</code></pre>
<pre><code class="language-bash">docker create network main
docker-compose -f  docker-compose-conf.yml
</code></pre>
<p>åˆ›å»º 3 ä¸ªå…±è¯†èŠ‚ç‚¹çš„ç›®å½•ç»“æ„å¦‚ä¸‹:</p>
<pre><code class="language-bash">$ ls test-chain/
0 1 2  template
$ ls 0
address     consensus.toml  forever.toml       logs
auth.toml   data            genesis.json       network.toml
chain.toml  executor.toml   jsonrpc.toml       privkey
</code></pre>
<p>å°†é…ç½®æ–‡ä»¶æ‹·è´åˆ°å…¶ä»–èŠ‚ç‚¹</p>
<ul>
<li>privkey : å­˜æ”¾ç§é’¥</li>
<li>address : å­˜æ”¾åœ°å€</li>
<li>*.toml : å„ä¸ªå¾®æœåŠ¡é…ç½®æ–‡ä»¶ï¼Œè¯¦ç»†è¯´æ˜è§å¾®æœåŠ¡è¯´æ˜</li>
<li>genesis.json ï¼š ç”Ÿæˆ genesis å—æ–‡ä»¶ï¼Œ å…¶ä¸­ timestamp ä¸ºæ—¶é—´æˆ³ï¼Œç§’ä¸ºå•ä½ï¼›prevhash -æŒ‡å‰ä¸€ä¸ªå—å“ˆå¸Œï¼Œè¿™é‡Œæ˜¯é»˜è®¤å€¼ï¼›è€Œ alloc æŒ‡éƒ¨ç½²åˆ°åˆ›ä¸–å—çš„åˆçº¦å†…å®¹ï¼›</li>
<li>test-chain/template ç›®å½•ä¸‹æ˜¯æ¨¡æ¿æ–‡ä»¶ï¼ŒåŒ…æ‹¬è¿™ä¸ªé“¾çš„å…±è¯†èŠ‚ç‚¹åœ°å€ test-chain/template/- authorities.listï¼Œç³»ç»Ÿå‚æ•° test-chain/template/init_data.yml, èŠ‚ç‚¹ç«¯å£åœ°å€ test-chain/template/nodes.list ç­‰ä¿¡æ¯</li>
<li>logs : è®°å½•é“¾è¿è¡Œçš„æ—¥å¿—ä¿¡æ¯</li>
<li>data : æ•°æ®å­˜å‚¨</li>
</ul>
<p>CITAæœ‰ä¸€äº›ä¿ç•™ç«¯å£ï¼Œè®¾ç½®èŠ‚ç‚¹ç½‘ç»œç«¯å£ï¼Œæˆ–è€…è‡ªå®šä¹‰ç«¯å£çš„æ—¶å€™è¦é¿å…äº§ç”Ÿç«¯å£å†²çªã€‚ä¿ç•™ç«¯å£æœ‰ï¼š<br>
é»˜è®¤çš„ jsonrpc ç«¯å£ï¼š1337 åˆ° 1337 + N<br>
é»˜è®¤çš„ websocket ç«¯å£ï¼š4337 åˆ° 4337+N<br>
å› ä¸ºæˆ‘ä»¬æ˜¯ä¸åŒçš„æœºå™¨æ‰€ä»¥ä¸ç”¨æ‹…å¿ƒç«¯å£å†²çªçš„é—®é¢˜ï¼Œå¯ä»¥ä¿®æ”¹jsonrpc.tomlæ–‡ä»¶ä¸Šé¢ä¸¤ä¸ªç«¯å£ä¸ºä¸€è‡´</p>
<h3 id="2-èŠ‚ç‚¹éƒ¨ç½²æ–‡ä»¶">2. èŠ‚ç‚¹éƒ¨ç½²æ–‡ä»¶</h3>
<p>node-1èŠ‚ç‚¹æ–‡ä»¶<br>
docker-compose-node0.yml</p>
<pre><code class="language-yml">version: '3'
networks:
  main:

  services:
    node0:
    container_name: node0
    image: cita/cita-release:20.2.0-sm2-sm3
    hostname: node0
    networks:
      main:
        aliases:
          - node0
    volumes:
      - ./:/opt/cita-run
    ports:
      - &quot;1337:1337&quot;
    command: |
      bash -c '
      while [[ ! -d /opt/cita-run/test-chain ]]; do sleep 1; done;
      sleep 10;
      cita setup test-chain/0;
      cita start test-chain/0;
      sleep infinity'
</code></pre>
<p>node-2èŠ‚ç‚¹æ–‡ä»¶<br>
docker-compose-node1.yml</p>
<pre><code class="language-yml">version: '3'
networks:
  main:

  services:
    node1:
    container_name: node1
    image: cita/cita-release:20.2.0-sm2-sm3
    hostname: node1
    networks:
      main:
        aliases:
          - node1
    volumes:
      - ./:/opt/cita-run
    ports:
      - &quot;1337:1337&quot;
    command: |
      bash -c '
      while [[ ! -d /opt/cita-run/test-chain ]]; do sleep 1; done;
      sleep 10;
      cita setup test-chain/1;
      cita start test-chain/1;
      sleep infinity'
</code></pre>
<p>node-2èŠ‚ç‚¹æ–‡ä»¶<br>
docker-compose-node2.yml<br>
...</p>
<h3 id="3-å¯åŠ¨æœåŠ¡">3. å¯åŠ¨æœåŠ¡</h3>
<p><code>docker-compose-node0.yml</code><br>
<code>docker-compose-node1.yml</code><br>
<code>docker-compose-node2.yml</code></p>
<h3 id="éªŒè¯-cita-æ˜¯å¦è¿è¡Œæ­£å¸¸">éªŒè¯ CITA æ˜¯å¦è¿è¡Œæ­£å¸¸</h3>
<p>è¿›å…¥å®¹å™¨æ‰§è¡Œå‘½ä»¤æ£€æŸ¥æœåŠ¡çŠ¶æ€</p>
<pre><code class="language-bash">docker exec -it node0 bash
root@node0:/opt/cita-run# cita top test-chain/0
root       2042      1  0 Aug25 ?        00:00:00 cita-forever
root       2051   2042  0 Aug25 ?        00:05:51 cita-auth -c auth.toml
root       2069   2042  0 Aug25 ?        00:02:10 cita-bft -c consensus.toml -p privkey
root       2061   2042  0 Aug25 ?        00:00:24 cita-chain -c chain.toml
root       2054   2042  0 Aug25 ?        00:01:50 cita-executor -c executor.toml
root       2062   2042  0 Aug25 ?        00:00:55 cita-jsonrpc -c jsonrpc.toml
root       2053   2042  0 Aug25 ?        00:05:40 cita-network -c network.toml

</code></pre>
<p>æ£€æŸ¥ 7 ä¸ªæœåŠ¡æ˜¯å¦éƒ½å·²ç»å¯åŠ¨ã€‚<br>
åˆ†åˆ«å»å…¶ä»–èŠ‚ç‚¹ä¾æ¬¡æ£€æŸ¥</p>
<p>æ£€æŸ¥æ—¥å¿—æœ‰æ— æŠ¥é”™æƒ…å†µ<br>
cita-network.logæ—¥å¿—ä¼šæœ‰<br>
<code>ERROR - [NodeManager] Can not get node status from known_addr, this should Â·not happen!</code><br>
å¿½ç•¥å³å¯</p>
<h2 id="åŸºæœ¬å‘½">åŸºæœ¬å‘½</h2>
<h3 id="æŸ¥çœ‹å—é«˜åº¦">æŸ¥çœ‹å—é«˜åº¦</h3>
<pre><code class="language-bash">cita-cli rpc blockNumber

{
  &quot;id&quot;: 1,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: &quot;0x13678&quot;
}

å…¶ä¸­ result è¡¨ç¤ºæœ¬æ¬¡æŸ¥è¯¢æ—¶çš„å—é«˜åº¦ä¸º 0x13678ã€‚ CITA é»˜è®¤ 3s å‡ºä¸€ä¸ªå—ï¼Œé‡å¤æ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤ï¼Œå¯ä»¥è§‚å¯Ÿåˆ° result åœ¨æŒç»­çš„å¢é•¿ã€‚
</code></pre>
<h3 id="éƒ¨ç½²åˆçº¦">éƒ¨ç½²åˆçº¦</h3>
<p>æ‰§è¡Œå‘½ä»¤</p>
<pre><code class="language-bash">cita-cli rpc sendRawTransaction \
    --code 0x608060405234801561001057600080fd5b5060df8061001f6000396000f3006080604052600436106049576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806360fe47b114604e5780636d4ce63c146078575b600080fd5b348015605957600080fd5b5060766004803603810190808035906020019092919050505060a0565b005b348015608357600080fd5b50608a60aa565b6040518082815260200191505060405180910390f35b8060008190555050565b600080549050905600a165627a7a723058205aed214856a5c433292a354261c9eb88eed1396c83dabbe105bde142e49838ac0029 \
    --private-key 0x3ef2627393529fed043c7dbfd9358a4ae47a88a59949b07e7631722fd6959002
    --url  http://127.0.0.1:1337   --algorithm sm2
</code></pre>
<p>è¯¥å‘½ä»¤å°†åˆçº¦çš„å­—èŠ‚ç éƒ¨ç½²åˆ°åŒºå—é“¾ä¸Šã€‚</p>
<p>å‘½ä»¤è¿”å›ï¼š</p>
<pre><code class="language-bash">{
  &quot;id&quot;: 4,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: {
    &quot;hash&quot;: &quot;0x36e7c55e48df9e465200c55cad1cb14fe677edc8ea087b97c9b8c1ed9495670e&quot;,
    &quot;status&quot;: &quot;OK&quot;
  }
}
</code></pre>
<h3 id="æŸ¥çœ‹å›æ‰§">æŸ¥çœ‹å›æ‰§</h3>
<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="language-bash">cita-cli rpc getTransactionReceipt --hash 0x36e7c55e48df9e465200c55cad1cb14fe677edc8ea087b97c9b8c1ed9495670e
</code></pre>
<p>å…¶ä¸­çš„ hash ä¸ºéƒ¨ç½²åˆçº¦çš„äº¤æ˜“ hashï¼Œæ‰€æŸ¥è¯¢çš„ç»“æœä¸ºéƒ¨ç½²åˆçº¦çš„äº¤æ˜“å›æ‰§ã€‚<br>
å‘½ä»¤è¿”å›ï¼š</p>
<pre><code class="language-bash">{
  &quot;id&quot;: 1,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: {
    &quot;blockHash&quot;: &quot;0xb9e2167e07550c55406acc22f8d3d83fa81cfd29430c9b5ffb5a7e58fbf130c0&quot;,
    &quot;blockNumber&quot;: &quot;0x136b3&quot;,
    &quot;contractAddress&quot;: &quot;0xb701924639d802dc8093d1a43dffa9939a4506de&quot;,
    &quot;cumulativeQuotaUsed&quot;: &quot;0x17d9d&quot;,
    &quot;errorMessage&quot;: null,
    &quot;logs&quot;: [
    ],
    &quot;logsBloom&quot;: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;,
    &quot;quotaUsed&quot;: &quot;0x17d9d&quot;,
    &quot;root&quot;: null,
    &quot;transactionHash&quot;: &quot;0x36e7c55e48df9e465200c55cad1cb14fe677edc8ea087b97c9b8c1ed9495670e&quot;,
    &quot;transactionIndex&quot;: &quot;0x0&quot;
  }
}
</code></pre>
<h3 id="æŸ¥çœ‹äº¤æ˜“">æŸ¥çœ‹äº¤æ˜“</h3>
<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="language-bash">cita-cli rpc getTransaction --hash  0x36e7c55e48df9e465200c55cad1cb14fe677edc8ea087b97c9b8c1ed9495670e
</code></pre>
<p>å…¶ä¸­çš„ hash ä¸ºéƒ¨ç½²åˆçº¦çš„äº¤æ˜“ hashï¼Œæ‰€æŸ¥è¯¢çš„ç»“æœä¸ºéƒ¨ç½²åˆçº¦çš„äº¤æ˜“ä¿¡æ¯ã€‚<br>
å‘½ä»¤è¿”å›ï¼š</p>
<pre><code class="language-bash">{
  &quot;id&quot;: 1,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: {
    &quot;blockHash&quot;: &quot;0xb9e2167e07550c55406acc22f8d3d83fa81cfd29430c9b5ffb5a7e58fbf130c0&quot;,
    &quot;blockNumber&quot;: &quot;0x136b3&quot;,
    &quot;content&quot;: &quot;0x0af202122032343532366161336362383834626164626166656261313437623932663939661880ade2042089ee042afe01608060405234801561001057600080fd5b5060df8061001f6000396000f3006080604052600436106049576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806360fe47b114604e5780636d4ce63c146078575b600080fd5b348015605957600080fd5b5060766004803603810190808035906020019092919050505060a0565b005b348015608357600080fd5b50608a60aa565b6040518082815260200191505060405180910390f35b8060008190555050565b600080549050905600a165627a7a723058205aed214856a5c433292a354261c9eb88eed1396c83dabbe105bde142e49838ac00293220000000000000000000000000000000000000000000000000000000000000000040025220000000000000000000000000000000000000000000000000000000000000000112413fd75865ad692e8903d05c4cadcca4b52621c5b6a4798c9300c2927f6c1b915210d5be6956d0cac8dea79b6a9ac0f1de09dee275eeb4bf871e08ad5a920f8fbb01&quot;,
    &quot;from&quot;: &quot;0x37d1c7449bfe76fe9c445e626da06265e9377601&quot;,
    &quot;hash&quot;: &quot;0x36e7c55e48df9e465200c55cad1cb14fe677edc8ea087b97c9b8c1ed9495670e&quot;,
    &quot;index&quot;: &quot;0x0&quot;
  }
}
</code></pre>
<p>å…¶ä¸­ content ä¸ºäº¤æ˜“æ•°æ®ã€‚ç”±äºæ•°æ®ç»è¿‡äº†ç­¾åå¤„ç†ï¼Œæ‰€ä»¥ä¸éƒ¨ç½²åˆçº¦æ—¶æŒ‡å®šçš„ --code ä¸ä¸€è‡´ã€‚å¯ä»¥ä½¿ç”¨ cita-cli æä¾›çš„ decode-unverifiedTransaction å‘½ä»¤æ¥è§£ç ã€‚</p>
<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="language-bash">cita-cli tx decode-unverifiedTransaction --content   0x0af202122032343532366161336362383834626164626166656261313437623932663939661880ade2042089ee042afe01608060405234801561001057600080fd5b5060df8061001f6000396000f3006080604052600436106049576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806360fe47b114604e5780636d4ce63c146078575b600080fd5b348015605957600080fd5b5060766004803603810190808035906020019092919050505060a0565b005b348015608357600080fd5b50608a60aa565b6040518082815260200191505060405180910390f35b8060008190555050565b600080549050905600a165627a7a723058205aed214856a5c433292a354261c9eb88eed1396c83dabbe105bde142e49838ac00293220000000000000000000000000000000000000000000000000000000000000000040025220000000000000000000000000000000000000000000000000000000000000000112413fd75865ad692e8903d05c4cadcca4b52621c5b6a4798c9300c2927f6c1b915210d5be6956d0cac8dea79b6a9ac0f1de09dee275eeb4bf871e08ad5a920f8fbb01
</code></pre>
<p>å‘½ä»¤è¿”å›ï¼š</p>
<pre><code class="language-bash">{
  &quot;crypto&quot;: 0,
  &quot;signature&quot;: &quot;0x3fd75865ad692e8903d05c4cadcca4b52621c5b6a4798c9300c2927f6c1b915210d5be6956d0cac8dea79b6a9ac0f1de09dee275eeb4bf871e08ad5a920f8fbb01&quot;,
  &quot;transaction&quot;: {
    &quot;chain_id&quot;: 0,
    &quot;chain_id_v1&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000001&quot;,
    &quot;data&quot;: &quot;0x608060405234801561001057600080fd5b5060df8061001f6000396000f3006080604052600436106049576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806360fe47b114604e5780636d4ce63c146078575b600080fd5b348015605957600080fd5b5060766004803603810190808035906020019092919050505060a0565b005b348015608357600080fd5b50608a60aa565b6040518082815260200191505060405180910390f35b8060008190555050565b600080549050905600a165627a7a723058205aed214856a5c433292a354261c9eb88eed1396c83dabbe105bde142e49838ac0029&quot;,
    &quot;encrypted_hash&quot;: &quot;0x8d434bd11a8f94f6fb128b1b941daa573daa21d795858f366fed1593f6eb30ff&quot;,
    &quot;nonce&quot;: &quot;24526aa3cb884badbafeba147b92f99f&quot;,
    &quot;pub_key&quot;: &quot;0x9dc6fc7856f5271e6e8c45e5c5fe22d2ff699ac3b24497599be77803d3c25fb4e2fe7da616c65a291910c947c89923009f354634421bddd0a25cd0a509bcf6a9&quot;,
    &quot;quota&quot;: 10000000,
    &quot;sender&quot;: &quot;0x37d1c7449bfe76fe9c445e626da06265e9377601&quot;,
    &quot;to&quot;: &quot;&quot;,
    &quot;to_v1&quot;: &quot;0x0000000000000000000000000000000000000000&quot;,
    &quot;valid_until_block&quot;: 79625,
    &quot;value&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,
    &quot;version&quot;: 2
  }
}
</code></pre>
<p>å…¶ä¸­çš„ data æ•°æ®ä¾¿ä¸éƒ¨ç½²åˆçº¦ä¸­æŒ‡å®šçš„ code ç›¸ä¸€è‡´ã€‚</p>
<h3 id="è°ƒç”¨åˆçº¦">è°ƒç”¨åˆçº¦</h3>
<p>æ‰§è¡Œå‘½ä»¤ï¼Œè°ƒç”¨ set å‡½æ•°ï¼š</p>
<pre><code class="language-bash">cita-cli rpc sendRawTransaction \
    --code 0x60fe47b10000000000000000000000000000000000000000000000000000000000000001 \
    --private-key 0x3ef2627393529fed043c7dbfd9358a4ae47a88a59949b07e7631722fd6959002 \
    --address 0xb701924639d802dc8093d1a43dffa9939a4506de
</code></pre>
<p>æ³¨æ„ï¼šè¿™é‡Œçš„ address è¦ä¸éƒ¨ç½²åˆçº¦å›æ‰§ä¸­çš„ contractAddress ç›¸ä¸€è‡´ã€‚</p>
<p>å‘½ä»¤è¿”å›ï¼š</p>
<pre><code class="language-bash">{
  &quot;id&quot;: 4,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: {
    &quot;hash&quot;: &quot;0xd68853e6df7893b5b2299abaf8cb2631e37b4047dbab55511c96c459efd2242b&quot;,
    &quot;status&quot;: &quot;OK&quot;
  }
}
</code></pre>
<h2 id="ä¿®æ”¹ä¸ªåˆ«é…ç½®æ“ä½œç¤ºä¾‹">ä¿®æ”¹ä¸ªåˆ«é…ç½®æ“ä½œç¤ºä¾‹</h2>
<p>èµ·é“¾åï¼Œä¹Ÿå°±æ˜¯è¯´åˆ›ä¸–å—ä¸€æ—¦ç”Ÿæˆï¼Œé™¤ chainNameã€operatorã€website ä¸‰é¡¹å¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ”¹ï¼Œå…¶ä»–é…ç½®å‡æ— æ³•ä¿®æ”¹ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ cita-cli æ¥è¿›è¡Œæ¼”ç¤ºï¼Œä»¥è¶…çº§ç®¡ç†å‘˜ä¿®æ”¹ chainName ä½œä¸ºç¤ºä¾‹ï¼š</p>
<p>ç¡®ä¿ä½ çš„é“¾æ­£å¸¸è¿è¡Œï¼Œè¿›å…¥ cita-cli äº¤äº’å¼æ¨¡å¼ï¼Œè¾“å…¥å‘½ä»¤ï¼š</p>
<pre><code class="language-bash">$ scm SysConfig setChainName --chain-name &quot;AAA&quot; --admin-private \ 0x5f0258a4778057a8a7d97809bd209055b2fbafa654ce7d31ec7191066b9225e6
</code></pre>
<p>æŸ¥è¯¢äº¤æ˜“å›æ‰§æ— è¯¯åï¼Œæˆ‘ä»¬æˆåŠŸçš„æŠŠé“¾åç§°ä»é»˜è®¤çš„ test-chain æ›´æ”¹ä¸º AAAã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ getMeta æŸ¥è¯¢æ›´æ”¹åçš„ç»“æœï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<p><code>rpc getMetaData</code></p>
<p>è¾“å‡ºï¼š</p>
<pre><code class="language-bash">{
  &quot;id&quot;: 1,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: {
    &quot;blockInterval&quot;: 3000,
    &quot;chainId&quot;: 1,
    &quot;chainName&quot;: &quot;AAA&quot;,
    &quot;economicalModel&quot;: 1,
    &quot;genesisTimestamp&quot;: 1538101178583,
    &quot;operator&quot;: &quot;test-operator&quot;,
    &quot;tokenAvatar&quot;: &quot;https://cdn.citahub.com/icon_cita.png&quot;,
    &quot;tokenName&quot;: &quot;CITA Test Token&quot;,
    &quot;tokenSymbol&quot;: &quot;CTT&quot;,
    &quot;validators&quot;: [
      &quot;0x185e7072f53574666cf8ed8ec080e09b7e39c98f&quot;
    ],
    &quot;version&quot;: 1,
    &quot;website&quot;: &quot;https://www.example.com&quot;
  }
}
</code></pre>
<h2 id="èŠ‚ç‚¹ç®¡ç†">èŠ‚ç‚¹ç®¡ç†</h2>
<h3 id="èŠ‚ç‚¹åˆ†ç±»">èŠ‚ç‚¹åˆ†ç±»</h3>
<p>CITAåŒºå—é“¾åˆ†ä¸ºä¸¤å¤§ç±»èŠ‚ç‚¹ï¼š</p>
<ul>
<li>å…±è¯†èŠ‚ç‚¹ï¼šå…±è¯†èŠ‚ç‚¹å…·æœ‰å‡ºå—å’ŒæŠ•ç¥¨æƒé™ï¼Œäº¤æ˜“ç”±å…±è¯†èŠ‚ç‚¹æ’åºå¹¶æ‰“åŒ…æˆå—ï¼Œå…±è¯†å®Œæˆåå³è¢«ç¡®è®¤ä¸ºåˆæ³•åŒºå—ã€‚</li>
<li>æ™®é€šèŠ‚ç‚¹ï¼šæ™®é€šèŠ‚ç‚¹æ²¡æœ‰å‡ºå—å’ŒæŠ•ç¥¨æƒé™ï¼Œå…¶ä»–æ–¹é¢å’Œå…±è¯†èŠ‚ç‚¹ç›¸åŒã€‚å¯ä»¥åŒæ­¥å’ŒéªŒè¯é“¾ä¸Šæ‰€æœ‰çš„åŸå§‹æ•°æ®ï¼Œæ¥å—äº¤æ˜“æ•°æ®å¹¶å‘å…¶ä»–èŠ‚ç‚¹å¹¿æ’­ã€‚</li>
</ul>
<p>###æ™®é€šèŠ‚ç‚¹ç®¡ç†<br>
æ™®é€šèŠ‚ç‚¹çš„ç®¡ç†ï¼Œæ˜¯æŒ‡æ™®é€šèŠ‚ç‚¹çš„æ·»åŠ ä¸åˆ é™¤ã€‚å½“å‰ CITA çš„èŠ‚ç‚¹å‘ç°æä¾›ä¸¤ç§æœºåˆ¶ï¼š</p>
<ul>
<li>è‡ªåŠ¨å‘ç°æœºåˆ¶ï¼Œæœ¬èŠ‚ç‚¹ä¼šè‡ªåŠ¨é€šè¿‡æ‰€é…ç½®çš„ peers å‘ç°ç½‘ç»œä¸­çš„å…¶å®ƒèŠ‚ç‚¹å¹¶å°è¯•è¿æ¥ã€‚</li>
<li>é…ç½®æ–‡ä»¶å‘ç°æœºåˆ¶ï¼Œæœ¬èŠ‚ç‚¹ä»…è¿æ¥ peers ä¸­æ‰€é…ç½®çš„èŠ‚ç‚¹ã€‚</li>
</ul>
<p>CITA çš„èŠ‚ç‚¹å‘ç°æœºåˆ¶é€šè¿‡ network ç½‘ç»œé…ç½® ä¸­çš„ enable_discovery é…ç½®é¡¹è®¾ç½®ã€‚</p>
<p><strong>æ·»åŠ æ™®é€šèŠ‚ç‚¹ï¼ˆä»¥ä¸‹ä»¥ 4 å·èŠ‚ç‚¹ä¸¾ä¾‹ï¼‰</strong></p>
<ol>
<li>å‡è®¾ç›®å‰çš„å·¥ä½œç›®å½•åœ¨ cita/target/install/ ä¸‹ï¼š</li>
</ol>
<pre><code class="language-bash">$ ls test-chain/
  0  1  2  3  template
</code></pre>
<p>template ä¸­ä¿å­˜äº†å½“å‰èŠ‚ç‚¹çš„å…¬é’¥åœ°å€ template/authorities.listï¼Œä»¥åŠåˆ›ä¸–å—ä¿¡æ¯ template/configs/genesis.jsonï¼Œç›®å‰åœ°å€æœ‰å››ä¸ªã€‚</p>
<ol start="2">
<li>ç”Ÿæˆæ–° nodeï¼š</li>
</ol>
<pre><code class="language-bash">$ ./bin/cita append --chain_name test-chain --node &quot;127.0.0.1:4004&quot;
$ ls test-chain/
  0  1  2  3  4  template
</code></pre>
<ul>
<li>append å­å‘½ä»¤ï¼Œåœ¨æŒ‡å®šé“¾ä¸­å¢åŠ å¯¹åº” ip åœ°å€çš„èŠ‚ç‚¹ã€‚</li>
<li>è„šæœ¬å°†è‡ªåŠ¨ç”Ÿæˆ 4 å·èŠ‚ç‚¹ï¼Œå¹¶åœ¨åŸæœ‰èŠ‚ç‚¹ä¸­ test-chain/*/network.toml ä¸­æ’å…¥æ–°èŠ‚ç‚¹çš„ ip åŠç«¯å£é…ç½®ã€‚</li>
</ul>
<blockquote>
<p>æ³¨ï¼š å¦‚æœä¸åŒæœºå™¨çš„èŠ‚ç‚¹å°±è¦æ‰‹åŠ¨å»ä¿®æ”¹ network.toml æ–‡ä»¶äº†</p>
</blockquote>
<ol start="3">
<li>å¯åŠ¨æ–°èŠ‚ç‚¹ï¼š</li>
</ol>
<p>æ–°èŠ‚ç‚¹åªéœ€è¦æŒ‰ç…§æ­£å¸¸æµç¨‹å¯åŠ¨ï¼Œå°±å¯ä»¥è¿æ¥å…¥ç½‘ç»œï¼Œå¹¶å¼€å§‹åŒæ­¥é“¾ä¸Šçš„å—æ•°æ®ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼š<br>
a. æ­¤æ—¶çš„æ–°èŠ‚ç‚¹ä¸ºæ™®é€šèŠ‚ç‚¹ï¼Œä¸å‚ä¸å…±è¯†é€‰ä¸¾ï¼Œå³åªèƒ½åŒæ­¥æ•°æ®å’Œæ¥æ”¶ jsonrpc è¯·æ±‚ã€‚<br>
b. å½“ network ç½‘ç»œé…ç½®ä¸º enable_discovery = false æ—¶ï¼Œéœ€è¦åœ¨åŸæ¥èŠ‚ç‚¹çš„ network.toml æ–‡ä»¶ä¸­ peers åŸŸæ·»åŠ æ–°èŠ‚ç‚¹ä¿¡æ¯ã€‚</p>
</blockquote>
<pre><code class="language-bash">$ ./bin/cita setup test-chain/4
$ ./bin/cita start test-chain/4
</code></pre>
<p><strong>åˆ é™¤æ™®é€šèŠ‚ç‚¹</strong></p>
<ul>
<li>å½“ network ç½‘ç»œé…ç½®ä¸º enable_discovery = false æ—¶ï¼Œåˆ°å¯¹åº”èŠ‚ç‚¹ç›®å½•ä¸‹ï¼Œæ‰¾åˆ° network.tomlï¼Œåˆ é™¤å¯¹åº” peers æ¡ç›®å³å¯ã€‚</li>
<li>å½“ network ç½‘ç»œé…ç½®ä¸º enable_discovery = true æ—¶ï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸»åŠ¨ä¸‹çº¿ï¼Œè¯¥èŠ‚ç‚¹ä¾¿åœ¨ç½‘ç»œä¸­è¢«ç§»é™¤ã€‚</li>
</ul>
<h3 id="å…±è¯†èŠ‚ç‚¹ç®¡ç†">å…±è¯†èŠ‚ç‚¹ç®¡ç†</h3>
<p>å¢åŠ å…±è¯†èŠ‚ç‚¹<br>
èŠ‚ç‚¹éœ€å…ˆè¢«æ·»åŠ æˆä¸ºæ™®é€šèŠ‚ç‚¹ï¼ˆå‚è€ƒæ™®é€šèŠ‚ç‚¹ç®¡ç†ï¼‰ï¼Œæ‰èƒ½ç”³è¯·æˆä¸ºå…±è¯†èŠ‚ç‚¹ï¼Œç”±è¶…çº§ç®¡ç†å‘˜ï¼ˆæ‹¥æœ‰è¶…çº§ç®¡ç†å‘˜è§’è‰²çš„è´¦å·ï¼‰ç¡®è®¤æ‰å®Œæˆäº†æ·»åŠ æ“ä½œã€‚</p>
<p>ä»æ™®é€šèŠ‚ç‚¹å‡çº§åˆ°å…±è¯†èŠ‚ç‚¹ï¼Œå…·ä½“æ“ä½œéœ€è¦ç”¨åˆ°ä¸Šé¢åˆçº¦æ–¹æ³• approveNode(address)ã€‚</p>
<p>å…±è¯†èŠ‚ç‚¹ç®¡ç†åˆçº¦æ˜¯ç³»ç»Ÿåˆçº¦ï¼Œé»˜è®¤å°†æ”¾åœ¨åˆ›ä¸–å—ä¸Šï¼Œä¸‹é¢ä½¿ç”¨ solc å‘½ä»¤ï¼ˆsolidity çš„å‘½ä»¤è¡Œç¼–è¯‘å™¨ï¼Œåœ¨ CITA é•œåƒä¸­å·²å®‰è£…ï¼‰æŸ¥çœ‹å…±è¯†èŠ‚ç‚¹ç®¡ç†åˆçº¦çš„ hashï¼š</p>
<pre><code class="language-bash">$ solc --hashes system/node_manager.sol --allow-paths .
contract address: 0xffffffffffffffffffffffffffffffffff020001
Function signatures:
    dd4c97a0: approveNode(address)
    2d4ede93: deleteNode(address)
    30ccebb5: getStatus(address)
    609df32f: listNode()
    6ed3876d: listStake()
    51222d50: setStake(address,uint64)
    0c829315: stakePermillage(address)
    645b8b1b: status(address)
</code></pre>
<p>é¦–å…ˆéœ€è¦å¯åŠ¨ä¸€æ¡é“¾ï¼Œå…·ä½“æ–¹æ³•è§å¿«é€Ÿå…¥é—¨éƒ¨åˆ†</p>
<p>æ¥ä¸‹æ¥çš„æµ‹è¯•ï¼Œç”¨ cita-cli å‘½ä»¤è¡Œæ¨¡å¼ï¼ˆä¸äº¤äº’å¼æ¨¡å¼çš„å‘½ä»¤æ˜¯ä¸€è‡´çš„ï¼‰è¿›è¡Œæ¼”ç¤ºã€‚</p>
<h4 id="æŸ¥çœ‹å½“å‰çš„å…±è¯†èŠ‚ç‚¹åˆ—è¡¨">æŸ¥çœ‹å½“å‰çš„å…±è¯†èŠ‚ç‚¹åˆ—è¡¨ï¼š</h4>
<p><code>cita-cli scm NodeManager listNode --url http://127.0.0.1:1337</code></p>
<p>è¾“å‡º:</p>
<pre><code class="language-bash">{
  &quot;id&quot;: 1,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: &quot;0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000020000000000000000000000004dd0951bd05d394324279cbcb2b40b4398938f56000000000000000000000000a222f39026a7423592de6fe00383de27facdd51a&quot;
}
</code></pre>
<p>è¿”å›å€¼ä¸ºç›®å‰çš„å…±è¯†èŠ‚ç‚¹åœ°å€åˆ—è¡¨ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬éœ€è¦å°†æ–°å¢çš„æ™®é€šèŠ‚ç‚¹é€šè¿‡äº¤æ˜“çš„æ–¹å¼å‡çº§ä¸ºå…±è¯†èŠ‚ç‚¹ï¼Œæ–°å¢çš„æ™®é€šèŠ‚ç‚¹çš„å…¬é’¥åœ°å€ï¼Œæ¼”ç¤ºä¸­ï¼Œä¸º 0xa800dab858271557b1e6e9e62eb8b2f22560da4b</p>
<ul>
<li>å‘é€äº¤æ˜“</li>
</ul>
<pre><code class="language-bash">$ cita-cli scm NodeManager approveNode \
    --address 0xa800dab858271557b1e6e9e62eb8b2f22560da4b \
    --admin-private 0x7664a098547142fdf7fc3a732607f707512f98df4d6b7040f009858813e257d5 \
    --url http://127.0.0.1:1337    --algorithm sm2
</code></pre>

<span id="footnote"></span>
<div id = "warn"></div>
</div>
<div class="toc-container"><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E5%85%B3%E4%BA%8E-cita">å…³äº CITA</a></li>
<li><a href="#%E5%AE%89%E8%A3%85-cita-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B7%A5%E5%85%B7">å®‰è£… CITA å®¢æˆ·ç«¯å·¥å…·</a>
<ul>
<li><a href="#%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E6%89%80%E5%9C%A8%E7%9A%84%E9%93%BE%E5%92%8C%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95">æŸ¥çœ‹å½“å‰æ‰€åœ¨çš„é“¾å’ŒåŠ å¯†ç®—æ³•</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%9C%B0%E5%9D%80-%E7%A7%81%E9%92%A5-%E5%85%AC%E9%92%A5">åˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦æˆ·åœ°å€ã€ç§é’¥ã€å…¬é’¥</a></li>
</ul>
</li>
<li><a href="#docker-compose-%E9%83%A8%E7%BD%B2cita%E6%9C%8D%E5%8A%A1">docker-compose éƒ¨ç½²citaæœåŠ¡</a>
<ul>
<li><a href="#1-%E7%94%9F%E6%88%90%E8%8A%82%E7%82%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">1. ç”ŸæˆèŠ‚ç‚¹é…ç½®æ–‡ä»¶</a></li>
<li><a href="#2-%E8%8A%82%E7%82%B9%E9%83%A8%E7%BD%B2%E6%96%87%E4%BB%B6">2. èŠ‚ç‚¹éƒ¨ç½²æ–‡ä»¶</a></li>
<li><a href="#3-%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1">3. å¯åŠ¨æœåŠ¡</a></li>
<li><a href="#%E9%AA%8C%E8%AF%81-cita-%E6%98%AF%E5%90%A6%E8%BF%90%E8%A1%8C%E6%AD%A3%E5%B8%B8">éªŒè¯ CITA æ˜¯å¦è¿è¡Œæ­£å¸¸</a></li>
</ul>
</li>
<li><a href="#%E5%9F%BA%E6%9C%AC%E5%91%BD">åŸºæœ¬å‘½</a>
<ul>
<li><a href="#%E6%9F%A5%E7%9C%8B%E5%9D%97%E9%AB%98%E5%BA%A6">æŸ¥çœ‹å—é«˜åº¦</a></li>
<li><a href="#%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6">éƒ¨ç½²åˆçº¦</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E5%9B%9E%E6%89%A7">æŸ¥çœ‹å›æ‰§</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E4%BA%A4%E6%98%93">æŸ¥çœ‹äº¤æ˜“</a></li>
<li><a href="#%E8%B0%83%E7%94%A8%E5%90%88%E7%BA%A6">è°ƒç”¨åˆçº¦</a></li>
</ul>
</li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%B8%AA%E5%88%AB%E9%85%8D%E7%BD%AE%E6%93%8D%E4%BD%9C%E7%A4%BA%E4%BE%8B">ä¿®æ”¹ä¸ªåˆ«é…ç½®æ“ä½œç¤ºä¾‹</a></li>
<li><a href="#%E8%8A%82%E7%82%B9%E7%AE%A1%E7%90%86">èŠ‚ç‚¹ç®¡ç†</a>
<ul>
<li><a href="#%E8%8A%82%E7%82%B9%E5%88%86%E7%B1%BB">èŠ‚ç‚¹åˆ†ç±»</a></li>
<li><a href="#%E5%85%B1%E8%AF%86%E8%8A%82%E7%82%B9%E7%AE%A1%E7%90%86">å…±è¯†èŠ‚ç‚¹ç®¡ç†</a>
<ul>
<li><a href="#%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E7%9A%84%E5%85%B1%E8%AF%86%E8%8A%82%E7%82%B9%E5%88%97%E8%A1%A8">æŸ¥çœ‹å½“å‰çš„å…±è¯†èŠ‚ç‚¹åˆ—è¡¨ï¼š</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="fullPage"><canvas id="canvas"></canvas></div>
</article>
<div id="eof"><span>EOF</span></div><div class="round-shape-one"></div>
<section>
<div class="doc_comments">
<div id="vcomments"></div>
    <script>
        new Valine({
            el: '#vcomments',
            appId: 'nCwKjHbRmhxBO6Dl20UfM5yw-gzGzoHsz',
            appKey: 'DiIo4l1dsGeJ9VKtPoGOjfN5',
			placeholder: 'å” ä¸¤å—é’±å„¿'
        })
    </script>

</div></section>
</div></div></div><script>
"use strict";!function(){for(var n=document.getElementsByTagName("pre"),e=n.length,s=0;s<e;s++){n[s].innerHTML='<span class="line-number"></span>'+n[s].innerHTML+'<span class="cl"></span>';for(var a=n[s].innerHTML.split(/\n/).length,r=0;r<a-1;r++){n[s].getElementsByTagName("span")[0].innerHTML+="<span>"+(r+1)+"</span>"}}}();
let mainNavLinks=document.querySelectorAll(".markdownIt-TOC a");window.addEventListener("scroll",event=>{let fromTop=window.scrollY;mainNavLinks.forEach((link,index)=>{let section=document.getElementById(decodeURI(link.hash).substring(1));let nextSection=null
if(mainNavLinks[index+1]){nextSection=document.getElementById(decodeURI(mainNavLinks[index+1].hash).substring(1));}
if(section.offsetTop<=fromTop){if(nextSection){if(nextSection.offsetTop>fromTop){link.classList.add("currentToc");}else{link.classList.remove("currentToc");}}else{link.classList.add("currentToc");}}else{link.classList.remove("currentToc");}});});
var list=document.querySelectorAll(".katex");for(var i=0;i<list.length;i++){list[i].style.display="unset"};
var h=document.documentElement,b=document.body,st="scrollTop",sh="scrollHeight",progress=document.querySelector(".progress"),scroll;document.addEventListener("scroll",function(){scroll=(h[st]||b[st])/((h[sh]||b[sh])-h.clientHeight)*100;progress.style.setProperty("--scroll",scroll+"%")});
var wxScale=new WxScale({fullPage:document.querySelector("#fullPage"),canvas:document.querySelector("#canvas")});var imgBox=document.querySelectorAll("#md_block img");for(var i=0;i<imgBox.length;i++){imgBox[i].onclick=function(e){wxScale.start(this)}};
content="æœ¬æ–‡æœ€åæ›´æ–°äº2020-08-25ï¼Œå·²è¶…è¿‡ 1 å¹´æ²¡æœ‰æ›´æ–°ï¼Œæ¶‰åŠçš„å†…å®¹å¯èƒ½å·²ç»å¤±æ•ˆï¼";var date1="2020-08-25 17:55:03";date1=date1.replace("-","/");var date2=new Date();var date3=date2.getTime()-new Date(date1).getTime();var days=Math.floor(date3/(24*3600*1000));if(days>=365){document.getElementById("warn").innerHTML=content};
</script>
<style>#magnifyImg{position:fixed;left:0;top:0;text-align:center;width:100%;display:none;z-index:9999}#magnifyImg img{object-fit:contain;background:#eaecef;padding:15px;border-radius:10px;height:auto;width:auto;vertical-align:middle}</style>
<a id="scrollUp" href="#top" style="position: fixed; z-index: 2147483647; display: block;"></a><div class="footer animated fadeInDown"><div class="site_footer"><div class="mysocials"><div class="my_socials"></div></div><div class="copyright"id="copyright">Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>Copyright Â© 2018-2020 <a href="https://chriswsq.github.io" style="margin:0;">chris&#39;wang</a>.</div>
<span style="display: inline;margin-right:15px;">ğŸ‘<strong><span id="busuanzi_value_site_uv"></span></strong></span><span id="busuanzi_container_page_pv" style="display: inline;"><span>ğŸ“š<strong>27</strong> posts</span></div></div>
<script>
console.log("\n %c \u26a1Theme: Bitcron-pro Author's Blog:https://blog.blinkstar.cn  Writen By Serence  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;", );
</script>
<script src="https://cdn.jsdelivr.net/npm/instant.page@3.0.0/instantpage.min.js" type="module" defer></script>
<script type="text/javascript" async src="https://chriswsq.github.io/media/js/prism.js"></script>
</body>
</html>